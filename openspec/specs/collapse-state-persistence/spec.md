### Requirement: 折り畳み状態の永続化

システムはタスクツリーの折り畳み状態を localStorage に永続化しなければならない（SHALL）。折り畳まれているタスクIDの一覧が保存され、ページリロード後も復元される。

#### Scenario: 折り畳み操作時の自動保存

- **WHEN** ユーザーがタスクの折り畳み/展開を操作する
- **THEN** 折り畳み状態が即座に localStorage に保存される

#### Scenario: 一括折り畳み操作時の自動保存

- **WHEN** ユーザーが「全て折り畳む」または「全て展開」を操作する
- **THEN** 折り畳み状態が即座に localStorage に保存される

### Requirement: 折り畳み状態の復元

システムはアプリ起動時に保存された折り畳み状態を復元しなければならない（SHALL）。

#### Scenario: 保存済み状態の復元

- **WHEN** アプリが起動し、localStorage に折り畳み状態が保存されている
- **THEN** 保存された折り畳み状態が復元され、以前折り畳まれていたタスクは折り畳まれた状態で表示される

#### Scenario: 保存データがない場合

- **WHEN** アプリが起動し、localStorage に折り畳み状態が保存されていない（初回起動など）
- **THEN** すべてのタスクが展開された状態で表示される

### Requirement: タスク削除時の折り畳み状態クリーンアップ

システムはタスク削除時に、削除されたタスクの折り畳み状態を除去しなければならない（SHALL）。

#### Scenario: 折り畳まれたタスクの削除

- **WHEN** 折り畳み状態が保存されているタスクが削除される
- **THEN** そのタスクの折り畳み状態が localStorage から除去される

#### Scenario: 子タスクを持つタスクの削除

- **WHEN** 子タスク（子孫を含む）を持つタスクが削除される
- **THEN** 削除されたタスクとその子孫すべての折り畳み状態が localStorage から除去される

### Requirement: エクスポート/インポートからの除外

折り畳み状態はタスクデータのエクスポート/インポートに含めてはならない（SHALL NOT）。

#### Scenario: タスクデータのエクスポート

- **WHEN** ユーザーがタスクデータをエクスポートする
- **THEN** エクスポートデータに折り畳み状態は含まれない

#### Scenario: タスクデータのインポート

- **WHEN** ユーザーがタスクデータをインポートする
- **THEN** 現在の折り畳み状態は変更されない
